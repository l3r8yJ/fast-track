<div class="issue-panel-header">
  <div class="issue-panel-title">
    <h1>{{ issue.title }}</h1>
    <p>Issue ID: {{ issue.id }}</p>
  </div>
  <button class="issue-delete-btn"
    hx-delete="/issues/{{ issue.id }}"
    hx-target="aside#issue-panel > article"
    hx-swap="innerHTML"
    hx-confirm="Delete this issue?">
    Delete
  </button>
</div>

<div class="issue-panel-content">
  {% if issue.description %}
  <div class="issue-section">
    <span class="issue-section-title">Description</span>
    <div class="issue-description">
      {{ issue.description | markdown }}
    </div>
  </div>
  {% endif %}

  <div class="issue-section">
    <span class="issue-section-title">Details</span>
    <div class="issue-meta">
      <div class="meta-row">
        <span class="meta-label">Status</span>
        <span class="meta-value">{{ issue.status_code }}</span>
      </div>
      <div class="meta-row">
        <span class="meta-label">Assignee</span>
        <span class="meta-value">{{ issue.assignee_fullname | default: "Unassigned" }}</span>
      </div>
      {% if issue.estimation %}
      <div class="meta-row">
        <span class="meta-label">Estimation</span>
        <span class="meta-value">{{ issue.estimation }}</span>
      </div>
      {% endif %}
      <div class="meta-row">
        <span class="meta-label">Created</span>
        <span class="meta-value"><small>{{ issue.created_at | date }}</small></span>
      </div>
      <div class="meta-row">
        <span class="meta-label">Updated</span>
        <span class="meta-value"><small>{{ issue.updated_at | date }}</small></span>
      </div>
    </div>
  </div>

  {% if prs %}
  <div class="issue-section">
    <span class="issue-section-title">Linked PRs</span>
    <div class="links-list">
      {% for pr in prs %}
      <a href="{{ pr.url }}" target="_blank" class="link-item">{{ pr.name }}</a>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  {% if tasks %}
  <div class="issue-section">
    <span class="issue-section-title">Linked Tasks</span>
    <div class="links-list">
      {% for t in tasks %}
      <a href="#"
        hx-get="/issues/{{ t.id }}"
        hx-target="aside#issue-panel > article"
        hx-swap="innerHTML"
        class="link-item">
        {{ t.title }}
      </a>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  {% if comments %}
  <div class="issue-section">
    <span class="issue-section-title">Comments ({{ comments | length }})</span>
    <div class="comments-list">
      {% for c in comments %}
      <div class="comment-item">
        <div class="comment-author">{{ c.author }}</div>
        <div class="comment-text">{{ c.text }}</div>
        <small class="comment-date">{{ c.created_at | date }}</small>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</div>
